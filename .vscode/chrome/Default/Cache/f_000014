{"version":3,"sources":["chessBoardSubPanel.js"],"names":["GLB","require","pool","cc","Class","extends","Component","properties","chess","Prefab","nextStep","onLoad","createPrefabPool","init","fPosList","chessBoradWidth","node","width","chessBoradHeight","height","rows","columns","longX","longY","x","areaLine","y","pos","v2","push","playing","mapParam01","mapParam02","clientEvent","on","eventType","mapInit","mapInitEvent","eatForChess","eatForChessEvent","eatForOther","openForOther","openChessPiece","openChessPieceEvent","checkMoveDirection","isGameOver","getMap","gameOver","overClear","clearChess","showChessArr","showStepArr","chessBoardList","oldChessNode","childrenNodes","children","val","destroy","removeAllChildren","touchBoardEvent","event","Game","GameManager","gameState","GameState","Play","convertToNodeSpace","getLocation","clickPos","console","log","parseInt","moveTag","chessMove","oldChess","sign","data","left","setEatfun","right","up","down","stepNode","clearDirection","animatPutDown","showChessInfo","param","isRoomOwner","j","length","chessNode","getPrefab","name","addChild","setPosition","chessScript","getComponent","setChessType","type","index","stepScrip","blueChessPiecesArr","redChessPiecesArr","k","stepNodeScrip","chessInfo","xx","Math","random","floor","PLAYER_FLAG","RED","splice","BLUE","msg","action","SEND_MAP_INFO","sendEventEx","msg02","move","cb","callback","getAnimateStep","clearMove","oldTag","oldStepNode","tag","enemyChess","ownerChess","isCanEatChess","currentChessNode","getChessNodeByTag","getStepNodeByTag","setMoveDirection","parm","getTagByIndex","getIsOpen","isEatChess","eatTag","eatOther","user","stepIfEatOrOpen","moveToKong","chessNodeScrip","isOpen","CHANGE_FLAG","EAT_FOR_OTHER","eatInfo","sendEvent","addTag","oldChessScrip","oldStepNodeScrip","getNode","stopAllActions","callF","callFunc","setAudio","clearOldChessNode","bind","runAction","sequence","moveTo","isEatStepChess","ownerStepChess","eatChangePosition","getPosition","pos2","ownerNode","ownerStepNode","index2","getIndex","shiftForBoardList","setDestory","chessSetDestory","zIndex","arrX","arrY","i","getStepByIndex","winFlag","userIsWin","GAME_OVER_EVENT","dispatch","stopTimeWarnAnim","isEatNode","isEatStepNode","scrip","onDestroy","off"],"mappings":"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","file":"chessBoardSubPanel.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\common\\script","sourcesContent":["var GLB = require(\"Glb\");\r\nvar pool = require(\"pool\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        chess: cc.Prefab,\r\n        nextStep: cc.Prefab\r\n    },\r\n\r\n    onLoad () {\r\n        pool.createPrefabPool(this.chess);\r\n        pool.createPrefabPool(this.nextStep);\r\n\r\n        this.init();\r\n        this.fPosList = [];\r\n\r\n        this.chessBoradWidth = this.node.width;\r\n        this.chessBoradHeight = this.node.height;\r\n        this.rows = 4;\r\n        this.columns = 4;\r\n        this.longX = this.chessBoradWidth / this.columns;\r\n        this.longY = this.chessBoradHeight / this.rows;\r\n\r\n\r\n        //初始化格子坐标\r\n        for(var x = 0;x <this.rows; x++){\r\n            var areaLine = [];\r\n            for(var y = 0; y < this.columns; y++){\r\n               // var pos = cc.p(-this.chessBoradWidth/2 + y*this.longX + this.longX/2, this.chessBoradHeight/2 - x*this.longY - this.longY/2);\r\n                var pos = cc.v2(-this.chessBoradWidth/2 + y*this.longX + this.longX/2, this.chessBoradHeight/2 - x*this.longY - this.longY/2 + 5);\r\n                areaLine[y] = pos;\r\n            }\r\n            this.fPosList.push(areaLine);\r\n        }\r\n\r\n        this.playing = false;\r\n\r\n        // TODO 加载声音；\r\n        this.mapParam01 = null;\r\n        this.mapParam02 = null;\r\n\r\n        clientEvent.on(clientEvent.eventType.mapInit, this.mapInitEvent, this);\r\n        clientEvent.on(clientEvent.eventType.eatForChess, this.eatForChessEvent, this)\r\n        clientEvent.on(clientEvent.eventType.eatForOther, this.eatForOther, this);\r\n        clientEvent.on(clientEvent.eventType.openForOther, this.openForOther, this);\r\n        clientEvent.on(clientEvent.eventType.openChessPiece, this.openChessPieceEvent, this);\r\n        clientEvent.on(clientEvent.eventType.checkMoveDirection, this.checkMoveDirection, this);\r\n        clientEvent.on(clientEvent.eventType.isGameOver, this.isGameOver, this);\r\n        clientEvent.on(clientEvent.eventType.getMap, this.getMap, this);\r\n        clientEvent.on(clientEvent.eventType.gameOver, this.overClear, this);\r\n        clientEvent.on(clientEvent.eventType.clearChess, this.overClear, this);\r\n        // this.node.on('touchend', this.touchBoardEvent, this);\r\n        //this.getMap();\r\n    },\r\n\r\n    init () {\r\n        this.showChessArr = [];//存棋子\r\n        this.showStepArr = [];\r\n        this.chessBoardList = [\r\n            [0, 0, 0, 0],\r\n            [0, 0, 0, 0],\r\n            [0, 0, 0, 0],\r\n            [0, 0, 0, 0]\r\n        ];\r\n    },\r\n\r\n    overClear () {\r\n        this.mapParam01 = null;\r\n        this.mapParam02  = null;\r\n        this.oldChessNode = null;\r\n        this.chessBoardList = [\r\n            [0, 0, 0, 0],\r\n            [0, 0, 0, 0],\r\n            [0, 0, 0, 0],\r\n            [0, 0, 0, 0]\r\n        ];\r\n        var childrenNodes = this.node.children;\r\n        for (const val of childrenNodes)  {\r\n            val.destroy();\r\n        }\r\n        this.node.removeAllChildren();\r\n\r\n    },\r\n\r\n    touchBoardEvent (event) {\r\n        if (Game.GameManager.gameState !== GameState.Play) return;\r\n        var pos = this.node.convertToNodeSpace(event.getLocation());\r\n        var clickPos = {x: pos.y/this.longY,\r\n            y:pos.x/this.longX};\r\n        if (clickPos.y%1 < 0.25 || clickPos.y%1 >0.7 || clickPos.x%1 < 0.25 || clickPos.x%1 >0.7 ) {\r\n            console.log(\"在界外\");\r\n            // if (this.oldChessNode) {\r\n            //     this.oldChessNode.clearDirection(true);\r\n            //     this.oldChessNode.animatPutDown();\r\n            // }\r\n            return;\r\n        }\r\n        var clickPos = {x:3 - parseInt(clickPos.x),y:parseInt(clickPos.y)};\r\n        // var moveTag = clickPos.x * 4 + clickPos.y;\r\n        var moveTag;\r\n        if (this.chessMove === true){\r\n            moveTag = {x:parseInt(this.oldChess.sign / 4),y:parseInt(this.oldChess.sign % 4)};\r\n            if (this.data.left) {\r\n                if (moveTag.y - 1 === clickPos.y && moveTag.x === clickPos.x) {\r\n                    this.setEatfun(this.oldChess.sign,null,-1,clickPos);\r\n                    console.log(\"成功移动\");\r\n                }\r\n            }\r\n            if (this.data.right) {\r\n                if (moveTag.y + 1 === clickPos.y && moveTag.x === clickPos.x) {\r\n                    this.setEatfun(this.oldChess.sign,null,1,clickPos);\r\n                    console.log(\"成功移动\");\r\n                }\r\n            }\r\n            if (this.data.up) {\r\n                if (moveTag.x  - 1 === clickPos.x && moveTag.y === clickPos.y) {\r\n                    this.setEatfun(this.oldChess.sign,null,-4,clickPos);\r\n                    console.log(\"成功移动\");\r\n                }\r\n            }\r\n            if (this.data.down) {\r\n                if (moveTag.x  + 1  === clickPos.x && moveTag.y === clickPos.y) {\r\n                    this.setEatfun(this.oldChess.sign,null,4,clickPos);\r\n                    console.log(\"成功移动\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    eatForChessEvent (stepNode) {\r\n        if (!this.chessMove) return;\r\n        this.eatForChess(stepNode);\r\n    },\r\n\r\n    openChessPieceEvent (stepNode) {\r\n        if (this.oldChessNode) {\r\n            this.oldChessNode.clearDirection();\r\n            this.oldChessNode.animatPutDown();\r\n        }\r\n    },\r\n\r\n    mapInitEvent (data) {\r\n        if(data.showChessInfo) {\r\n            this.mapParam01 = data.showChessInfo;\r\n        } else if(data.chessBoardList){\r\n            this.mapParam02 = data.chessBoardList;\r\n        }\r\n        if(this.mapParam01 && this.mapParam02) {\r\n            var param = {\r\n                showChessInfo: this.mapParam01,\r\n                chessBoardList: this.mapParam02\r\n            }\r\n            this.mapInit(param);\r\n        }\r\n    },\r\n\r\n    mapInit (data) {\r\n        console.log('*******这里是mapInit*********');\r\n        if(GLB.isRoomOwner) return;\r\n        this.showChessArr = [];\r\n        this.showStepArr = []\r\n        var showChessInfo = data[\"showChessInfo\"];\r\n        this.chessBoardList = data.chessBoardList;\r\n        for(var j = 0;j < showChessInfo.length; j++){\r\n            var chessNode = pool.getPrefab(this.chess.name);\r\n            this.node.addChild(chessNode);\r\n            chessNode.setPosition(showChessInfo[j].pos);\r\n            chessNode.sign = showChessInfo[j].sign;\r\n            var chessScript = chessNode.getComponent(this.chess.name);\r\n            this.showChessArr.push(chessNode);\r\n            chessScript.setChessType(showChessInfo[j].type, showChessInfo[j].index);\r\n\r\n            var stepNode = pool.getPrefab(this.nextStep.name);\r\n            var stepScrip = stepNode.getComponent(this.nextStep.name);\r\n            this.node.addChild(stepNode);\r\n            stepScrip.setChessType(showChessInfo[j].type, showChessInfo[j].index);\r\n            stepNode.setPosition(showChessInfo[j].pos);\r\n            stepNode.sign = showChessInfo[j].sign;\r\n            this.showStepArr.push(stepNode);\r\n        }\r\n    },\r\n\r\n    getMap () {\r\n        // 主机生成地图数据；\r\n        if(!GLB.isRoomOwner) return;\r\n        // // 先清空棋子数据（主机不会收到）；\r\n        // var chessMsg = {\r\n        //     action: GLB.CLEAR_CHESS,\r\n        // }\r\n        // Game.GameManager.sendEvent(chessMsg)\r\n\r\n        this.showChessInfo = [];\r\n        this.showChessArr = [];\r\n        this.showStepArr = [];\r\n        var blueChessPiecesArr = [1,2,3,4,5,6,7,8];\r\n        var redChessPiecesArr = [11,12,13,14,15,16,17,18];\r\n\r\n        for(var j = 0;j <this.rows; j++){\r\n            for(var k = 0; k < this.columns; k++){\r\n                var chessNode = pool.getPrefab(this.chess.name);\r\n                this.node.addChild(chessNode);\r\n                chessNode.setPosition(this.fPosList[j][k]);\r\n                chessNode.sign = j*this.columns + k;\r\n                var chessScript = chessNode.getComponent(this.chess.name);\r\n                this.showChessArr.push(chessNode);\r\n\r\n                var stepNode = pool.getPrefab(this.nextStep.name);\r\n                var stepNodeScrip =stepNode.getComponent(this.nextStep.name);\r\n\r\n                this.node.addChild(stepNode);\r\n                stepNode.setPosition(this.fPosList[j][k]);\r\n                stepNode.sign = j*this.columns + k;\r\n                this.showStepArr.push(stepNode);\r\n\r\n                var chessInfo = {pos:this.fPosList[j][k], sign:chessNode.sign};\r\n                var xx = Math.random();\r\n                if(xx >= 0.5)\r\n                {\r\n                    if(blueChessPiecesArr.length == 0)\r\n                    {\r\n                        if(redChessPiecesArr.length == 0)\r\n                        {\r\n                            break;\r\n                        }\r\n                        var index = Math.floor(Math.random()*redChessPiecesArr.length);\r\n                        chessScript.setChessType(GLB.PLAYER_FLAG.RED, redChessPiecesArr[index]);\r\n                        stepNodeScrip.setChessType(GLB.PLAYER_FLAG.RED, redChessPiecesArr[index]);\r\n                        chessInfo.type = GLB.PLAYER_FLAG.RED;\r\n                        chessInfo.index = redChessPiecesArr[index];\r\n                        this.chessBoardList[j][k] = redChessPiecesArr[index];\r\n                        redChessPiecesArr.splice(index, 1);\r\n                    }\r\n                    else\r\n                    {\r\n                        var index = Math.floor(Math.random()*blueChessPiecesArr.length);\r\n                        chessScript.setChessType(GLB.PLAYER_FLAG.BLUE, blueChessPiecesArr[index]);\r\n                        stepNodeScrip.setChessType(GLB.PLAYER_FLAG.BLUE, blueChessPiecesArr[index]);\r\n                        chessInfo.type = GLB.PLAYER_FLAG.BLUE;\r\n                        chessInfo.index = blueChessPiecesArr[index];\r\n                        this.chessBoardList[j][k] = blueChessPiecesArr[index];\r\n                        blueChessPiecesArr.splice(index, 1);\r\n                    }\r\n\r\n                }\r\n                else if(xx < 0.5)\r\n                {\r\n                    if(redChessPiecesArr.length == 0)\r\n                    {\r\n                        if(blueChessPiecesArr.length == 0)\r\n                        {\r\n                            break;\r\n                        }\r\n                        var index = Math.floor(Math.random()*blueChessPiecesArr.length);\r\n                        chessScript.setChessType(GLB.PLAYER_FLAG.BLUE, blueChessPiecesArr[index]);\r\n                        stepNodeScrip.setChessType(GLB.PLAYER_FLAG.BLUE, blueChessPiecesArr[index]);\r\n                        chessInfo.type = GLB.PLAYER_FLAG.BLUE;\r\n                        chessInfo.index = blueChessPiecesArr[index];\r\n                        this.chessBoardList[j][k] = blueChessPiecesArr[index];\r\n                        blueChessPiecesArr.splice(index, 1);\r\n                    }\r\n                    else{\r\n                        var index = Math.floor(Math.random()*redChessPiecesArr.length);\r\n                        chessScript.setChessType(GLB.PLAYER_FLAG.RED, redChessPiecesArr[index]);\r\n                        stepNodeScrip.setChessType(GLB.PLAYER_FLAG.RED, redChessPiecesArr[index]);\r\n                        chessInfo.type = GLB.PLAYER_FLAG.RED;\r\n                        chessInfo.index = redChessPiecesArr[index];\r\n                        this.chessBoardList[j][k] = redChessPiecesArr[index];\r\n                        redChessPiecesArr.splice(index, 1);\r\n                    }\r\n\r\n                }\r\n                this.showChessInfo.push(chessInfo);\r\n            }\r\n        }\r\n        // TODO 派发事件\r\n        var msg = {\r\n            action: GLB.SEND_MAP_INFO,\r\n            showChessInfo: this.showChessInfo,\r\n            // chessBoardList: this.chessBoardList\r\n            // mapInfo: {\r\n            //     showChessInfo: this.showChessInfo,\r\n            //     chessBoardList: this.chessBoardList\r\n            // }\r\n        };\r\n        Game.GameManager.sendEventEx(msg);\r\n        var msg02 = {\r\n            action: GLB.SEND_MAP_INFO,\r\n            chessBoardList: this.chessBoardList,\r\n        }\r\n        Game.GameManager.sendEventEx(msg02)\r\n    },\r\n\r\n    checkMoveDirection (param) {\r\n        var stepNode = param.node ;\r\n        var move = param.move;\r\n        var cb = param.callback;\r\n        if (this.oldChessNode) {\r\n            if (this.oldChessNode.getAnimateStep()) {\r\n                stepNode.getComponent(this.nextStep.name).clearMove();\r\n                return;\r\n            }\r\n        }\r\n        this.chessMove = move;//为true时是拿起棋子\r\n        if (this.oldTag !== stepNode.sign) {\r\n            if (this.oldStepNode) {\r\n                this.oldStepNode.getComponent(this.nextStep.name).clearMove();\r\n               this.oldStepNode = null;\r\n            }\r\n        }\r\n        if (this.chessMove === false) {\r\n            console.log(\"放下棋子\");\r\n            if (this.oldChessNode) {\r\n                this.oldChessNode.clearDirection();\r\n                this.oldChessNode.animatPutDown();\r\n                this.oldChessNode = null;\r\n            }\r\n            return;\r\n        }\r\n\r\n        var data ={left:false,right:false,up:false,down:false};\r\n        this.data = data;\r\n        if (this.oldChessNode) {\r\n            this.oldChessNode.clearDirection(true);\r\n            this.oldChessNode.animatPutDown();\r\n        }\r\n\r\n\r\n        var tag = stepNode.sign;\r\n        this.oldTag = tag;\r\n        var x = Math.floor(tag/this.columns);\r\n        var y = tag%this.columns;\r\n        if(y - 1 >= 0)\r\n        {\r\n            // this.checkLeft();\r\n            var enemyChess = this.chessBoardList[parseInt((tag - 1)/4)][(tag - 1)%4];\r\n            var ownerChess = this.chessBoardList[parseInt((tag)/4)][(tag)%4];\r\n            data = this.isCanEatChess(enemyChess,ownerChess, data, \"left\");\r\n\r\n        }\r\n        if(y+1 <= this.columns - 1)\r\n        {\r\n            // this.checkRight();\r\n            var enemyChess = this.chessBoardList[parseInt((tag + 1)/4)][(tag + 1)%4];\r\n            var ownerChess = this.chessBoardList[parseInt((tag)/4)][(tag)%4];\r\n            data = this.isCanEatChess(enemyChess,ownerChess, data,\"right\");\r\n        }\r\n        if(x-1 >= 0)\r\n        {\r\n            // this.checkUp();\r\n            var enemyChess = this.chessBoardList[parseInt((tag - 4)/4)][(tag - 4)%4];\r\n            var ownerChess = this.chessBoardList[parseInt((tag)/4)][(tag)%4];\r\n            data = this.isCanEatChess(enemyChess,ownerChess, data,\"up\");\r\n        }\r\n        if(x+1 <= this.rows - 1)\r\n        {\r\n            var enemyChess = this.chessBoardList[parseInt((tag + 4)/4)][(tag + 4)%4];\r\n            var ownerChess = this.chessBoardList[parseInt((tag)/4)][(tag)%4];\r\n            data = this.isCanEatChess(enemyChess,ownerChess, data,\"down\");\r\n        }\r\n\r\n        this.currentChessNode = this.getChessNodeByTag(tag);\r\n        this.oldStepNode = this.getStepNodeByTag(tag);\r\n        this.oldChess = this.currentChessNode;\r\n        this.oldChessNode = this.currentChessNode.getComponent(this.currentChessNode.name);\r\n        this.oldChessNode.setMoveDirection(data,cb);\r\n    },\r\n\r\n    //判断子粒大小\r\n    isCanEatChess:function(enemyChess,ownerChess, data, parm) {\r\n        if ((parseInt(enemyChess/10) !== parseInt(ownerChess/10)) || (enemyChess === 0)) {\r\n            if (enemyChess === 0) {\r\n                data[parm] = true;\r\n                data[\"largeThan\" + parm] = true;//\r\n                return data;\r\n            }\r\n            var tag = this.getTagByIndex(enemyChess).sign;\r\n            var stepNode = this.getStepNodeByTag(tag);\r\n            var stepNodeScrip = stepNode.getComponent(this.nextStep.name);\r\n            if (!stepNodeScrip.getIsOpen()) {\r\n                return data;\r\n            }\r\n            data[parm] = true;\r\n            if (enemyChess % 10 > ownerChess % 10) {\r\n                data[\"largeThan\" + parm] = false;//\r\n            } else {\r\n                data[\"largeThan\" + parm] = true;//\r\n            }\r\n\r\n            if (enemyChess % 10 === 8 && ownerChess % 10 === 1) {\r\n                data[\"largeThan\" + parm] = true;//\r\n            } else if (ownerChess % 10 === 8 && enemyChess % 10 === 1) {\r\n                data[\"largeThan\" + parm] = false;//\r\n            }\r\n\r\n        }\r\n        return data;\r\n    },\r\n\r\n    eatForChess:function(isEatChess) {\r\n        if (!this.chessMove) return;\r\n        if (!this.oldChess) {\r\n            return;\r\n        }\r\n        var oldTag = this.oldChess.sign;\r\n        if(this.data.left)\r\n        {\r\n            if (typeof oldTag !== \"undefined\" && ((isEatChess.sign + 1) === oldTag)) {\r\n                this.setEatfun(oldTag,isEatChess.sign,-1);\r\n            }\r\n        }\r\n        if(this.data.right)\r\n        {\r\n\r\n            if (typeof oldTag !== \"undefined\" && (isEatChess.sign - 1 === oldTag)) {\r\n                this.setEatfun(oldTag,isEatChess.sign,1);\r\n            }\r\n        }\r\n        if(this.data.up)\r\n        {\r\n            if (typeof oldTag !== \"undefined\" && (isEatChess.sign + 4 === oldTag)) {\r\n                this.setEatfun(oldTag,isEatChess.sign,-4);\r\n            }\r\n        }\r\n        if(this.data.down)\r\n        {\r\n            if (typeof oldTag !== \"undefined\" && (isEatChess.sign - 4 === oldTag)) {\r\n                this.setEatfun(oldTag,isEatChess.sign,4);\r\n            }\r\n        }\r\n    },\r\n\r\n    eatForOther (data) {\r\n        if (data.eatTag !== null) {\r\n            this.eatOther(data.oldTag,data.eatTag,data.sign);\r\n            user.stepIfEatOrOpen(1);\r\n        } else {\r\n            this.moveToKong(data.oldTag,data.sign,data.clickPos);\r\n            user.stepIfEatOrOpen(3);\r\n        }\r\n    },\r\n\r\n    openForOther (tag) {\r\n        var stepNode = this.getStepNodeByTag(tag);\r\n        var chessNode = this.getChessNodeByTag(tag);\r\n        var stepNodeScrip = stepNode.getComponent(this.nextStep.name);\r\n        var chessNodeScrip = chessNode.getComponent(this.chess.name);\r\n        if(stepNodeScrip.isOpen) return;\r\n        stepNodeScrip.openChessPiece();\r\n        chessNodeScrip.openChessPiece();\r\n    },\r\n\r\n    setEatfun:function(oldTag,eatTag,tag,clickPos){\r\n        if (eatTag !== null) {\r\n\r\n            var msg = {action: GLB.CHANGE_FLAG};\r\n            Game.GameManager.sendEventEx(msg);\r\n            // user.isMyTurn = false;\r\n            this.eatOther(oldTag,eatTag,tag);//吃敌方\r\n            user.stepIfEatOrOpen(1);\r\n\r\n        } else {\r\n            // user.isMyTurn = false;\r\n\r\n            var msg = {action: GLB.CHANGE_FLAG};\r\n            Game.GameManager.sendEventEx(msg);\r\n            this.moveToKong(oldTag,tag,clickPos);//走空地\r\n\r\n        }\r\n\r\n        this.chessMove = false;\r\n\r\n        // 发送被吃的消息\r\n        // user.sendGameData(user.gameDataProto.eatOther, {\r\n        //     oldTag:oldTag,eatTag:eatTag,tag:tag,clickPos:clickPos\r\n        // });\r\n        var msg = {\r\n            action: GLB.EAT_FOR_OTHER,\r\n            eatInfo: {\r\n                oldTag: oldTag,eatTag: eatTag,sign: tag,clickPos: clickPos\r\n            }\r\n        };\r\n        Game.GameManager.sendEvent(msg);\r\n\r\n        if (eatTag === null) {\r\n            user.stepIfEatOrOpen(3, true);\r\n        }\r\n    },\r\n\r\n    moveToKong:function(oldChess,addTag,clickPos) {\r\n        this.chessBoardList[parseInt(oldChess/4)][parseInt(oldChess%4)] = 0;\r\n        var oldChessNode = this.getChessNodeByTag(oldChess);\r\n        var oldStepNode = this.getStepNodeByTag(oldChess);\r\n        oldChessNode.sign += addTag;\r\n        oldStepNode.sign += addTag;\r\n        var oldChessScrip = oldChessNode.getComponent(this.chess.name);\r\n        var oldStepNodeScrip = oldStepNode.getComponent(this.nextStep.name);\r\n        let y = clickPos.y;\r\n        let x = clickPos.x;\r\n        var pos = cc.v2(-this.chessBoradWidth/2 + y*this.longX + this.longX/2, this.chessBoradHeight/2 - x*this.longY - this.longY/2);\r\n        // oldChessScrip.getNode().setPosition(pos);\r\n        oldChessScrip.getNode().stopAllActions();\r\n        var callF = cc.callFunc(function () {\r\n            user.setAudio(\"pieceClick\");\r\n            this.clearOldChessNode(function(){\r\n                oldStepNodeScrip.getNode().setPosition(pos);\r\n                this.chessBoardList[clickPos.x][clickPos.y] = oldChessScrip.index + 1;\r\n                this.isGameOver();\r\n            }.bind(this));\r\n        }.bind(this));\r\n        oldChessScrip.getNode().runAction(cc.sequence(cc.moveTo(0.2,pos),callF));\r\n        // oldChessScrip.getNode().runAction(cc.moveTo(0.2,pos));\r\n    },\r\n\r\n    eatOther:function(oldTag, eatTag,tag) {\r\n        var isEatChess = this.getChessNodeByTag(eatTag).getComponent(this.chess.name);\r\n        var isEatStepChess = this.getStepNodeByTag(eatTag).getComponent(this.nextStep.name);\r\n        var ownerChess = this.getChessNodeByTag(oldTag).getComponent(this.chess.name);\r\n        var ownerStepChess = this.getStepNodeByTag(oldTag).getComponent(this.nextStep.name);\r\n        if (isEatChess.index % 10 > ownerChess.index % 10) {\r\n            console.log(\"被吃掉\");\r\n            if ((isEatChess.index % 10 + 1) === 8 && (ownerChess.index % 10 + 1) === 1) {\r\n                this.eatChangePosition(ownerChess, ownerStepChess, isEatChess, isEatStepChess, 1, tag);\r\n            } else {\r\n                this.eatChangePosition(ownerChess, ownerStepChess, isEatChess, isEatStepChess, -1, tag);\r\n            }\r\n\r\n        } else if (isEatChess.index % 10 + 1 === ownerChess.index % 10 + 1) {\r\n            this.eatChangePosition(ownerChess, ownerStepChess, isEatChess, isEatStepChess, 0, tag);\r\n            console.log(\"换掉\");\r\n            user.stepIfEatOrOpen(1);\r\n        } else {\r\n            if (isEatChess.index % 10 + 1 === 1 && ownerChess.index % 10 + 1 === 8) {\r\n                this.eatChangePosition(ownerChess, ownerStepChess, isEatChess, isEatStepChess, -1, tag);\r\n            } else {\r\n                this.eatChangePosition(ownerChess, ownerStepChess, isEatChess, isEatStepChess, 1, tag);\r\n            }\r\n\r\n            console.log(\"吃掉对方\");\r\n        }\r\n\r\n    },\r\n\r\n    eatChangePosition:function(ownerChess,ownerStepChess,isEatChess,isEatStepChess, parm,tag) {\r\n        var pos = isEatChess.getPosition();\r\n        var pos2 = isEatStepChess.getPosition();\r\n        var ownerNode = ownerChess.getNode();\r\n        if (parm > 0) {\r\n            ownerNode.stopAllActions();\r\n            ownerNode.runAction(cc.sequence(cc.moveTo(0.2,pos),cc.callFunc(function() {\r\n                // TODO 播放音乐\r\n                user.setAudio(\"eat\");\r\n                this.clearOldChessNode(function(){\r\n                    ownerNode.sign += tag;\r\n                    var ownerStepNode = ownerStepChess.getNode();\r\n                    ownerStepNode.sign += tag;\r\n                    ownerNode.stopAllActions();\r\n                    ownerNode.runAction(cc.moveTo(0.2,pos));\r\n                    // ownerChess.setPosition(pos);\r\n                    ownerStepChess.setPosition(pos2);\r\n                    var index2 = isEatChess.getIndex();\r\n                    var index = ownerChess.getIndex();\r\n                    this.shiftForBoardList(index);\r\n                    this.shiftForBoardList(index2,index);\r\n                    isEatChess.setDestory();\r\n                    isEatStepChess.setDestory();\r\n                    this.chessSetDestory(null,null,isEatChess,isEatStepChess);\r\n                    this.isGameOver();\r\n                }.bind(this));\r\n            }.bind(this))));\r\n        } else if (parm === 0) {\r\n            ownerNode.zIndex = 100;\r\n            ownerNode.stopAllActions();\r\n            ownerNode.runAction(cc.sequence(cc.moveTo(0.2,pos),cc.callFunc(function() {\r\n                // TODO 播放音乐\r\n                user.setAudio(\"allDie\");\r\n                this.clearOldChessNode(function(){\r\n                    var index = isEatChess.getIndex();\r\n                    this.shiftForBoardList(index);\r\n                    index = ownerChess.getIndex();\r\n                    this.shiftForBoardList(index);\r\n                    isEatChess.setDestory();\r\n                    isEatStepChess.setDestory();\r\n                    ownerChess.setDestory();\r\n                    ownerStepChess.setDestory();\r\n                    this.chessSetDestory(ownerChess,ownerStepChess,isEatChess,isEatStepChess);\r\n                    this.isGameOver();\r\n                }.bind(this),1);\r\n            }.bind(this))));\r\n        } else {\r\n            ownerNode.zIndex = 100;\r\n            ownerNode.stopAllActions();\r\n            ownerNode.runAction(cc.sequence(cc.moveTo(0.2,pos),cc.callFunc(function(){\r\n                // TODO 播放音乐\r\n                user.setAudio(\"eat\");\r\n                this.clearOldChessNode(function(){\r\n                    var index = ownerChess.getIndex();\r\n                    this.shiftForBoardList(index);\r\n                    ownerChess.setDestory();\r\n                    ownerStepChess.setDestory();\r\n                    this.chessSetDestory(ownerChess,ownerStepChess,null,null);\r\n                    this.isGameOver();\r\n                }.bind(this), 1);\r\n            }.bind(this))));\r\n\r\n        }\r\n\r\n    },\r\n\r\n    isGameOver:function(){\r\n        var x,y;\r\n        var arrX = [], arrY = [];\r\n        var i;\r\n        for (i = 0; i < this.chessBoardList.length; i++) {\r\n            for (var j = 0; j < this.chessBoardList[i].length; j++) {\r\n                if (this.chessBoardList[i][j] <=0) {\r\n                    continue;\r\n                }\r\n\r\n                // 判断是否有未开的棋子\r\n                var isOpen = this.getStepByIndex(this.chessBoardList[i][j]).getComponent(\"nextStep\").getIsOpen();\r\n                if (!isOpen) {\r\n                    return;\r\n                }\r\n\r\n                // 判断是否只有一方的棋子\r\n                if (this.chessBoardList[i][j] >= 10) {      // 红色\r\n                    x = true;\r\n                    arrX.push(this.chessBoardList[i][j]);\r\n                } else if (this.chessBoardList[i][j] > 0){      // 蓝色\r\n                    y = true;\r\n                    arrY.push(this.chessBoardList[i][j]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // 判断是否只剩下两个开着的子\r\n        if (arrX.length === 1 && arrY.length === 1) {\r\n            if (arrX[0] - 10 > arrY[0]) {\r\n                y = false;\r\n            } else if (arrX[0] - 10 < arrY[0]) {\r\n                x = false;\r\n            } else {\r\n                x = false;\r\n                y = false;\r\n            }\r\n        }\r\n\r\n        if (!x || !y) {\r\n            // TODO 判断输赢\r\n            console.log('游戏结束')\r\n            var winFlag = null;\r\n            var userIsWin = false;\r\n            // user.gameOver = true;\r\n            // Game.GameManager.gameState = GameState.Over;\r\n            if (!x && !y) {\r\n                console.log(\"和局\");\r\n                // clientEvent.dispatchEvent(\"resultDown\",\"2\");\r\n            } else {\r\n                if (!GLB.isRoomOwner && !y) {  // 红方赢了\r\n                    console.log(\"你输了\");\r\n                    winFlag = GLB.PLAYER_FLAG.RED;\r\n                //    clientEvent.dispatchEvent(\"resultDown\",\"3\");\r\n                } else if (GLB.isRoomOwner && !x) {  // 蓝色方赢了\r\n                    console.log(\"你输了\");\r\n                    winFlag = GLB.PLAYER_FLAG.BLUE;\r\n                //    clientEvent.dispatchEvent(\"resultDown\",\"3\");\r\n                } else {\r\n                    console.log(\"你赢了\");\r\n                    var userIsWin = true;\r\n                //    clientEvent.dispatchEvent(\"resultDown\",\"1\");\r\n                }\r\n            }\r\n            if (userIsWin) {\r\n                if (GLB.isRoomOwner) {\r\n                    winFlag = GLB.PLAYER_FLAG.RED;\r\n                } else {\r\n                    winFlag = GLB.PLAYER_FLAG.BLUE;\r\n                }\r\n            }\r\n            var msg = {\r\n                action: GLB.GAME_OVER_EVENT,\r\n                winFlag: winFlag\r\n            }\r\n            Game.GameManager.sendEventEx(msg);\r\n            clientEvent.dispatch(clientEvent.eventType.stopTimeWarnAnim);\r\n        }\r\n    },\r\n\r\n    chessSetDestory:function(ownerChess,ownerStepChess,isEatChess,isEatStepChess) {\r\n        if (ownerChess !== null && ownerStepChess !== null) {\r\n            var ownerNode = ownerChess.getNode();\r\n            ownerNode.sign = 100;\r\n            var ownerStepNode = ownerStepChess.getNode();\r\n            ownerStepNode.sign = 100;\r\n        }\r\n        if (isEatChess !== null && isEatStepChess !== null) {\r\n            var isEatNode = isEatChess.getNode();\r\n            isEatNode.sign = 100;\r\n            var isEatStepNode = isEatStepChess.getNode();\r\n            isEatStepNode.sign = 100;\r\n        }\r\n    },\r\n\r\n    shiftForBoardList:function(index,index2) {\r\n        for (var i = 0; i < this.chessBoardList.length;i++) {\r\n            for (var j = 0; j < this.chessBoardList[i].length;j++) {\r\n                if (this.chessBoardList[i][j] === index) {\r\n                    if (index === 0) {\r\n                        console.log(\"this.chessBoardList[i][j]出错\");\r\n                    }\r\n                    if (index2) {\r\n                        this.chessBoardList[i][j] = index2;\r\n                    } else {\r\n                        this.chessBoardList[i][j] = 0;\r\n                    }\r\n\r\n                }\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    clearOldChessNode:function(cb,parm) {\r\n        if (this.oldStepNode) {\r\n            this.oldStepNode.getComponent(this.nextStep.name).clearMove();\r\n            this.oldStepNode = null;\r\n        }\r\n        if (this.oldChessNode) {\r\n            this.oldChessNode.clearDirection();\r\n            this.oldChessNode.animatPutDown(cb,parm);\r\n        } else {\r\n            if (cb){\r\n                cb();\r\n            }\r\n        }\r\n    },\r\n\r\n    getChessNodeByTag:function (tag) {\r\n        for(var i = 0; i < this.showChessArr.length; i++)\r\n        {\r\n            if(this.showChessArr[i].sign === tag)\r\n            {\r\n                return this.showChessArr[i];\r\n            }\r\n        }\r\n    },\r\n\r\n    getStepNodeByTag:function (tag) {\r\n        for(var i = 0; i < this.showStepArr.length; i++)\r\n        {\r\n            if(this.showStepArr[i].sign === tag)\r\n            {\r\n                return this.showStepArr[i];\r\n            }\r\n        }\r\n    },\r\n\r\n    getStepByIndex:function (index) {\r\n        for(var i = 0; i < this.showStepArr.length; i++)\r\n        {\r\n            var scrip = this.showStepArr[i].getComponent(this.nextStep.name);\r\n            if(scrip.getIndex() === index)\r\n            {\r\n                return this.showStepArr[i];\r\n            }\r\n        }\r\n    },\r\n\r\n    getTagByIndex:function (index) {\r\n        for(var i = 0; i < this.showChessArr.length; i++)\r\n        {\r\n            var scrip = this.showChessArr[i].getComponent(this.chess.name);\r\n            if(scrip.getIndex() === index)\r\n            {\r\n                return this.showChessArr[i];\r\n            }\r\n        }\r\n    },\r\n\r\n    onDestroy () {\r\n        clientEvent.off(clientEvent.eventType.mapInit, this.mapInitEvent, this);\r\n        clientEvent.off(clientEvent.eventType.eatForChess, this.eatForChessEvent, this)\r\n        clientEvent.off(clientEvent.eventType.eatForOther, this.eatForOther, this);\r\n        clientEvent.off(clientEvent.eventType.openForOther, this.openForOther, this);\r\n        clientEvent.off(clientEvent.eventType.openChessPiece, this.openChessPieceEvent, this);\r\n        clientEvent.off(clientEvent.eventType.checkMoveDirection, this.checkMoveDirection, this);\r\n        clientEvent.off(clientEvent.eventType.isGameOver, this.isGameOver, this);\r\n        clientEvent.off(clientEvent.eventType.getMap, this.getMap, this);\r\n        clientEvent.off(clientEvent.eventType.gameOver, this.overClear, this);\r\n        clientEvent.off(clientEvent.eventType.clearChess, this.overClear, this);\r\n        // this.node.off('touchend', this.touchBoardEvent, this);\r\n    }\r\n    // start () {\r\n    //\r\n    // },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}