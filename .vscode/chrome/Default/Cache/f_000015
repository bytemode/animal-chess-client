{"version":3,"sources":["uiGamePanel.js"],"names":["GLB","require","cc","Class","extends","Component","properties","redHeadBg","SpriteFrame","blueHeadBg","redArrow","blueArrow","leftHeadBg","default","type","Sprite","rightHeadBg","leftHead","rightHead","leftArrowSprite","rightArrowSprite","onLoad","timeNode","node","getChildByName","timeLeftNode","timeRightNode","timeNumNode","timeNumLabel","getComponent","Label","timeAnim","Animation","readyNode","readyAnim","on","notifyReady","clientEvent","eventType","updateTime","countTime","changeFlag","roundStart","gameOver","stopTimeWarnAnim","readyGoAudio","AudioSource","setTimeNumFont","clearInterval","interval","fontSize","console","log","timeLabelInit","playerFlag","PLAYER_FLAG","RED","user","init","headColorInit","dispatch","getMap","playReadyGo","setHeadIcon","exit","uiFunc","openUI","isRoomOwner","Game","GameManager","gameState","GameState","Play","time","countDownEvent","setInterval","winFlag","BLUE","msg","action","GAME_OVER_EVENT","sendEvent","bind","getTurn","isMyTurn","panel","uiRoundTip","setData","ROUND_TIP","SELF","flag","preTurn","showCurTurnLabel","active","param","side","playTimeWarnAnim","string","onDestroy","off","play","stop","setScale","camp","logic","getCampById","uid","spriteFrame","id","playerUserIds","gameStart","tihs","nano","notify"],"mappings":"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","file":"uiGamePanel.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\common\\script","sourcesContent":["var GLB = require(\"Glb\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        redHeadBg: cc.SpriteFrame, // 红蓝头像框图片\r\n        blueHeadBg: cc.SpriteFrame,\r\n\r\n        redArrow: cc.SpriteFrame,// 红蓝箭头图片\r\n        blueArrow: cc.SpriteFrame,\r\n\r\n        //左右头像框\r\n        leftHeadBg: {\r\n            default: null,\r\n            type: cc.Sprite\r\n        },\r\n\r\n        rightHeadBg: {\r\n            default: null,\r\n            type: cc.Sprite\r\n        },\r\n\r\n        //左右头像 左边默认是自己\r\n        leftHead: {\r\n            default: null,\r\n            type: cc.Sprite\r\n        },\r\n\r\n        rightHead:{\r\n            default: null,\r\n            type:cc.Sprite\r\n        },\r\n\r\n        //左右箭头\r\n        leftArrowSprite: {\r\n            default: null,\r\n            type: cc.Sprite\r\n        },\r\n\r\n        rightArrowSprite:{\r\n            default: null,\r\n            type:cc.Sprite\r\n        },\r\n    },\r\n\r\n    onLoad () {\r\n        //回合时间节点\r\n        this.timeNode = this.node.getChildByName('time');\r\n        this.timeLeftNode = this.timeNode.getChildByName('left'); //我方\r\n        this.timeRightNode = this.timeNode.getChildByName('right'); //他仿\r\n\r\n        //倒计时\r\n        this.timeNumNode = this.timeNode.getChildByName('num');\r\n        this.timeNumLabel = this.timeNumNode.getComponent(cc.Label);\r\n        //时间动画\r\n        this.timeAnim = this.timeNumNode.getComponent(cc.Animation);\r\n\r\n        //readygo ani\r\n        this.readyNode = this.node.getChildByName('readyGo');\r\n        this.readyAnim = this.readyNode.getComponent(cc.Animation);\r\n        this.readyAnim.on('finished', this.notifyReady, this);\r\n\r\n        clientEvent.on(clientEvent.eventType.updateTime, this.updateTime, this);\r\n        clientEvent.on(clientEvent.eventType.countTime, this.countTime, this);\r\n        clientEvent.on(clientEvent.eventType.changeFlag, this.changeFlag, this);\r\n        clientEvent.on(clientEvent.eventType.roundStart, this.roundStart, this);\r\n        clientEvent.on(clientEvent.eventType.gameOver, this.gameOver, this);\r\n        clientEvent.on(clientEvent.eventType.stopTimeWarnAnim, this.stopTimeWarnAnim, this);\r\n\r\n        this.readyGoAudio = this.readyNode.getComponent(cc.AudioSource);\r\n    },\r\n\r\n    gameOver () {\r\n        this.stopTimeWarnAnim();\r\n        this.setTimeNumFont();\r\n        clearInterval(this.interval);\r\n    },\r\n\r\n    setTimeNumFont () {\r\n        this.timeNumLabel.fontSize = 35;\r\n    },\r\n\r\n    roundStart () {\r\n        console.log('------roundStart------')\r\n        this.timeLabelInit();\r\n        clearInterval(this.interval);\r\n        this.playerFlag = GLB.PLAYER_FLAG.RED;\r\n        user.init();\r\n        this.headColorInit();\r\n        clientEvent.dispatch(clientEvent.eventType.getMap);\r\n        this.playReadyGo();\r\n        this.setTimeNumFont();\r\n        this.setHeadIcon();\r\n    },\r\n\r\n    exit() {\r\n        uiFunc.openUI(\"uiExit\");\r\n    },\r\n\r\n    countTime () {\r\n        clearInterval(this.interval);\r\n        if (!GLB.isRoomOwner || Game.GameManager.gameState !== GameState.Play) return;\r\n        this.time = 30;\r\n        this.countDownEvent();\r\n        this.interval = setInterval(function() {\r\n            this.time--;\r\n            this.countDownEvent();\r\n            if (this.time <= 0) {\r\n                if (Game.GameManager.gameState === GameState.Play) {\r\n                    console.log('超时；获胜方====' + (this.playerFlag === GLB.PLAYER_FLAG.RED ? '蓝色':'红色'));\r\n                    var winFlag = this.playerFlag === GLB.PLAYER_FLAG.RED ? GLB.PLAYER_FLAG.BLUE : GLB.PLAYER_FLAG.RED\r\n                    // Game.GameManager.gameState = GameState.Over;\r\n                    var msg = {\r\n                        action: GLB.GAME_OVER_EVENT,\r\n                        winFlag: winFlag\r\n                    }\r\n                    Game.GameManager.sendEvent(msg);\r\n                    clientEvent.dispatch(clientEvent.eventType.gameOver, winFlag);\r\n                }\r\n                clearInterval(this.interval);\r\n                this.interval = null;\r\n\r\n            }\r\n        }.bind(this), 1000);\r\n    },\r\n\r\n    changeFlag () {\r\n        this.playerFlag === GLB.PLAYER_FLAG.RED ? this.playerFlag = GLB.PLAYER_FLAG.BLUE :this.playerFlag = GLB.PLAYER_FLAG.RED;\r\n        this.getTurn(this.playerFlag);\r\n        if (user.isMyTurn) {\r\n            uiFunc.openUI('uiRoundTip', function (panel) {\r\n                var uiRoundTip = panel.getComponent('uiRoundTip');\r\n                uiRoundTip.setData(GLB.ROUND_TIP.SELF);\r\n            })\r\n        }\r\n        this.countTime();\r\n    },\r\n\r\n    getTurn (flag) {\r\n        // var flag = this.playerFlag;\r\n        var preTurn = user.isMyTurn;\r\n        if(GLB.isRoomOwner && flag === GLB.PLAYER_FLAG.RED) {\r\n            user.isMyTurn = true;\r\n        } else if(!GLB.isRoomOwner && flag === GLB.PLAYER_FLAG.BLUE){\r\n            user.isMyTurn = true;\r\n        } else {\r\n            user.isMyTurn = false;\r\n        }\r\n        if (preTurn === user.isMyTurn) return;\r\n        this.showCurTurnLabel();\r\n        this.timeNode.active = true;\r\n    },\r\n\r\n    //显示回合信息\r\n    showCurTurnLabel () {\r\n        if (user.isMyTurn) {\r\n            this.timeLeftNode.active = true;\r\n            this.timeRightNode.active = false;\r\n        } else {\r\n            this.timeLeftNode.active = false;\r\n            this.timeRightNode.active = true;\r\n        }\r\n    },\r\n\r\n    updateTime (param) {\r\n        // if (Game.GameManager.gameState !== GameState.Play) return;\r\n        var side = null;\r\n        var time = param.time;\r\n        if (time <= 5 && time > 0) {\r\n            this.playTimeWarnAnim();\r\n        }\r\n        if (time <= 0) {\r\n            this.stopTimeWarnAnim();\r\n        }\r\n        this.getTurn(param.flag);\r\n        user.isMyTurn ? side = 'Left' : side = 'Right';\r\n        this.timeNumLabel.string = time;\r\n    },\r\n\r\n    onDestroy () {\r\n        console.log('uiGamePanel onDestroy');\r\n        clearInterval(this.interval);\r\n        clientEvent.off(clientEvent.eventType.updateTime, this.updateTime, this);\r\n        clientEvent.off(clientEvent.eventType.countTime, this.countTime, this);\r\n        clientEvent.off(clientEvent.eventType.changeFlag, this.changeFlag, this);\r\n        clientEvent.off(clientEvent.eventType.roundStart, this.roundStart, this);\r\n        clientEvent.off(clientEvent.eventType.gameOver, this.gameOver, this);\r\n        clientEvent.off(clientEvent.eventType.stopTimeWarnAnim, this.stopTimeWarnAnim, this);\r\n    },\r\n\r\n\r\n    //----------------------------------------------------------------------\r\n    playReadyGo() {\r\n        this.readyAnim.play();\r\n        this.readyGoAudio.play();\r\n    },\r\n\r\n    playTimeWarnAnim () {\r\n        this.timeAnim.play();\r\n    },\r\n\r\n    stopTimeWarnAnim () {\r\n        this.timeAnim.stop();\r\n    },\r\n\r\n    //初始化时间控件\r\n    timeLabelInit () {\r\n        this.timeNode.active = false;\r\n        this.timeNumLabel.string = 30;\r\n        this.timeNode.getChildByName('num').setScale(1, 1);\r\n    },\r\n\r\n    //初始化头像信息\r\n    headColorInit () {\r\n        //我方头像放置在左侧\r\n        var camp = Game.GameManager.logic.getCampById(Game.GameManager.uid) //1 为红 2 为蓝\r\n        if (camp == 1){\r\n            this.leftArrowSprite.spriteFrame = this.redArrow;\r\n            this.leftHeadBg.spriteFrame = this.redHeadBg;\r\n\r\n            this.rightArrowSprite.spriteFrame = this.blueArrow;\r\n            this.rightHeadBg.spriteFrame = this.blueHeadBg;\r\n        }else{\r\n            this.leftArrowSprite.spriteFrame = this.blueArrow;\r\n            this.leftHeadBg.spriteFrame = this.blueHeadBg;\r\n\r\n            this.rightArrowSprite.spriteFrame = this.redArrow;\r\n            this.rightHeadBg.spriteFrame = this.redHeadBg;\r\n        }\r\n    },\r\n\r\n    //设置头像\r\n    setHeadIcon () {\r\n        this.leftHead.getComponent('playerIcon').setData({id: GLB.playerUserIds[0]});\r\n        this.rightHead.getComponent('playerIcon').setData({id: GLB.playerUserIds[1]});\r\n    },\r\n\r\n    //收到发牌消息,游戏开始\r\n    gameStart: function(){\r\n        Game.GameManager.gameState = GameState.Play;\r\n\r\n        //初始化红蓝头像 初始化箭头等红蓝信息 自己在左侧\r\n        this.headColorInit()\r\n\r\n        //设置头像信息\r\n        this.setHeadIcon()\r\n\r\n        //初始化时间信息\r\n        this.timeLabelInit()\r\n\r\n        //初始化棋盘\r\n\r\n        //播放readygo动画完成之后开始回合的通知\r\n        tihs.playReadyGo()\r\n    },\r\n\r\n    //read go 之后开始通知服务器客户端准备完成\r\n    notifyReady: function(){\r\n        nano.notify(\"game.QiPaiFinished\", {}) \r\n    },\r\n});\r\n"]}